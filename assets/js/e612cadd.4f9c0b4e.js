"use strict";(self.webpackChunksaga_docs=self.webpackChunksaga_docs||[]).push([[360],{3905:(e,t,r)=>{r.d(t,{Zo:()=>g,kt:()=>k});var a=r(7294);function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},o=Object.keys(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var s=a.createContext({}),u=function(e){var t=a.useContext(s),r=t;return e&&(r="function"==typeof e?e(t):l(l({},t),e)),r},g=function(e){var t=u(e.components);return a.createElement(s.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var r=e.components,n=e.mdxType,o=e.originalType,s=e.parentName,g=i(e,["components","mdxType","originalType","parentName"]),d=u(r),k=n,m=d["".concat(s,".").concat(k)]||d[k]||p[k]||o;return r?a.createElement(m,l(l({ref:t},g),{},{components:r})):a.createElement(m,l({ref:t},g))}));function k(e,t){var r=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var o=r.length,l=new Array(o);l[0]=d;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i.mdxType="string"==typeof e?e:n,l[1]=i;for(var u=2;u<o;u++)l[u]=r[u];return a.createElement.apply(null,l)}return a.createElement.apply(null,r)}d.displayName="MDXCreateElement"},2246:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>p,frontMatter:()=>o,metadata:()=>i,toc:()=>u});var a=r(7462),n=(r(7294),r(3905));const o={},l="Bruk av BigQuery",i={unversionedId:"bigquery/bruk-av-bigquery",id:"bigquery/bruk-av-bigquery",title:"Bruk av BigQuery",description:"Det finnes mange forskjellige m\xe5ter \xe5 bruke BigQuery p\xe5. Du kan eksempelvis bruke BigQuery fra:",source:"@site/docs/04-bigquery/01-bruk-av-bigquery.md",sourceDirName:"04-bigquery",slug:"/bigquery/bruk-av-bigquery",permalink:"/docs-public/bigquery/bruk-av-bigquery",draft:!1,editUrl:"https://github.com/svvsaga/docs-public/edit/main/docs/04-bigquery/01-bruk-av-bigquery.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Analyse i BigQuery",permalink:"/docs-public/bigquery/"},next:{title:"Nyttig SQL-kunnskap",permalink:"/docs-public/bigquery/nyttig-sql-kunnskap"}},s={},u=[{value:"Bruke BigQuery fra Google Cloud Console",id:"bruke-bigquery-fra-google-cloud-console",level:2},{value:"Koble seg til BigQuery fra PowerBI",id:"koble-seg-til-bigquery-fra-powerbi",level:2},{value:"Koble seg til BigQuery fra kommandolinje p\xe5 egen maskin",id:"koble-seg-til-bigquery-fra-kommandolinje-p\xe5-egen-maskin",level:2},{value:"Laste opp egne datasett",id:"laste-opp-egne-datasett",level:2},{value:"Laste ned datasett og resultater",id:"laste-ned-datasett-og-resultater",level:2}],g={toc:u};function p(e){let{components:t,...o}=e;return(0,n.kt)("wrapper",(0,a.Z)({},g,o,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"bruk-av-bigquery"},"Bruk av BigQuery"),(0,n.kt)("p",null,"Det finnes mange forskjellige m\xe5ter \xe5 bruke BigQuery p\xe5. Du kan eksempelvis bruke BigQuery fra:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Google Cloud Console"),(0,n.kt)("li",{parentName:"ul"},"Egen maskin (via ",(0,n.kt)("inlineCode",{parentName:"li"},"bq")," eller et SQL-verkt\xf8y)"),(0,n.kt)("li",{parentName:"ul"},"Jupyter Notebooks, eksempelvis i ",(0,n.kt)("a",{parentName:"li",href:"https://colab.research.google.com/"},"Google Colab")),(0,n.kt)("li",{parentName:"ul"},"Egenskrevne applikasjoner")),(0,n.kt)("h2",{id:"bruke-bigquery-fra-google-cloud-console"},"Bruke BigQuery fra Google Cloud Console"),(0,n.kt)("p",null,"Den desidert enkleste m\xe5ten \xe5 komme i gang med BigQuery p\xe5 er via Google Cloud Console. Her kan man bl.a. utforske eksisterende datasett, deres skjema og kj\xf8re SQL-sp\xf8rringer direkte i nettleseren."),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Eksempel p\xe5 bruk av BigQuery i Google Cloud Console",src:r(3430).Z,width:"1545",height:"700"}),"."),(0,n.kt)("p",null,"Bes\xf8k ",(0,n.kt)("a",{parentName:"p",href:"https://console.cloud.google.com/bigquery"},"BigQuery i Google Cloud Console")),(0,n.kt)("h2",{id:"koble-seg-til-bigquery-fra-powerbi"},"Koble seg til BigQuery fra PowerBI"),(0,n.kt)("p",null,"For \xe5 koble seg til BigQuery fra PowerBI anbefaler vi \xe5 ",(0,n.kt)("a",{parentName:"p",href:"https://docs.microsoft.com/en-us/power-bi/connect-data/desktop-connect-bigquery"},"f\xf8lge denne guiden."),", men i tillegg trengs det et ekstra steg. Alle sp\xf8rringer i BigQuery m\xe5 kj\xf8re i et prosjekt, og dette prosjektet trenger ikke \xe5 v\xe6re det samme prosjektet hvor dataene ligger. Dette prosjektet m\xe5 v\xe6re et prosjekt som du har tilgang til \xe5 opprette ressurser i. For datavitere er dette typisk prosjektet du har f\xe5tt tildelt som har et navn p\xe5 formen ",(0,n.kt)("inlineCode",{parentName:"p"},"saga-<navn>-playground-<suffix>"),"."),(0,n.kt)("p",null,"Dermed skal du g\xe5 ",(0,n.kt)("a",{parentName:"p",href:"https://docs.microsoft.com/en-us/power-query/connectors/googlebigquery#connect-using-advanced-options"},"inn i avanserte innstillinger"),' og sette feltet "Billing Project ID" til ditt prosjekt.'),(0,n.kt)("h2",{id:"koble-seg-til-bigquery-fra-kommandolinje-p\xe5-egen-maskin"},"Koble seg til BigQuery fra kommandolinje p\xe5 egen maskin"),(0,n.kt)("p",null,"For \xe5 kalle BigQuery fra egen maskin m\xe5 du ha satt opp autentisering. Den enkleste m\xe5ten \xe5 gj\xf8re dette p\xe5 er \xe5 bruke ",(0,n.kt)("a",{parentName:"p",href:"https://cloud.google.com/sdk/docs/install"},"Google Cloud CLI (gcloud)"),"."),(0,n.kt)("p",null,"N\xe5r du har fulgt installasjonsveilederen i linken over, kan du kj\xf8re f\xf8lgende:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"gcloud auth login\ngcloud auth application-default login\n")),(0,n.kt)("p",null,"For hver av disse vil du f\xe5 opp en nettside der du m\xe5 godkjenne innlogging med din ",(0,n.kt)("inlineCode",{parentName:"p"},"<fornavn.etternavn>@vegvesen.no"),"-bruker."),(0,n.kt)("p",null,"F\xf8r du kan begynne \xe5 gj\xf8re sp\xf8rringer b\xf8r du sette opp default project og default quota project (sett inn IDen til ditt prosjekt):"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"gcloud config set project saga-olanor-playground-1234\ngcloud auth application-default set-quota-project saga-olanor-playground-1234\n")),(0,n.kt)("h2",{id:"laste-opp-egne-datasett"},"Laste opp egne datasett"),(0,n.kt)("p",null,"Hvis du har egne datasett liggende i CSV eller JSON-format og \xf8nsker \xe5 bruke disse til analyse i BigQuery kan du f\xf8lge Googles guide for ",(0,n.kt)("a",{parentName:"p",href:"https://cloud.google.com/bigquery/docs/loading-data-cloud-storage-csv#loading_csv_data_into_a_table"},"CSV"),", ",(0,n.kt)("a",{parentName:"p",href:"https://cloud.google.com/bigquery/docs/loading-data-cloud-storage-json#loading_json_data_into_a_new_table"},"JSON")," og mange andre formater."),(0,n.kt)("h2",{id:"laste-ned-datasett-og-resultater"},"Laste ned datasett og resultater"),(0,n.kt)("p",null,"Det finnes mange m\xe5ter \xe5 hente data ut fra BigQuery p\xe5. Her f\xf8lger en forklaring p\xe5 hvordan datasett og resultat av sp\xf8rringer i BigQuery Cloud Console enkelt kan eksporteres som JSON."),(0,n.kt)("p",null,"For \xe5 kunne eksportere data m\xe5 du f\xf8rst ha opprettet en GCP-bruker og et prosjekt."),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},"G\xe5 til ",(0,n.kt)("a",{parentName:"li",href:"https://console.cloud.google.com/bigquery?p=saga-vegvar-prod-znny&d=standardized&t=maalestasjoner&page=table"},"M\xe5lestasjoner-datasettet i BigQuery"),".")),(0,n.kt)("p",null,"Prosjektet i prosjektvelgeren skal v\xe6re satt til ditt personlige prosjekt. Det gj\xf8r at du f\xe5r lov \xe5 kj\xf8re sp\xf8rringer mot BigQuery."),(0,n.kt)("ol",{start:2},(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Legg inn f\xf8lgende sp\xf8rring:"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-sql"},'SELECT\n  ANY_VALUE(navn) navn,\n  ANY_VALUE(lokasjon) lokasjon,\n  MIN(lufttemperaturCelsius) minTemperatur,\n  MAX(lufttemperaturCelsius) maksTemperatur,\n  DATE(maaletidspunkt, "Europe/Oslo") dato\nFROM `saga-vegvar-prod-znny.standardized.maaledata` md\nJOIN `saga-vegvar-prod-znny.standardized.maalestasjoner` ms\n  ON md.maalestasjonId = ms.id AND md.maalestasjonVersjon = ms.versjon\nWHERE DATE(maaletidspunkt, "Europe/Oslo") BETWEEN "2022-01-01" AND "2022-01-07"\nGROUP BY ms.id, ms.versjon, dato\nORDER BY dato, navn\n')))),(0,n.kt)("p",null,"Denne sp\xf8rringen vil hente ut alle minimums- og maksimumstemperaturer mellom 1. og 7. januar 2022."),(0,n.kt)("ol",{start:3},(0,n.kt)("li",{parentName:"ol"},"Kj\xf8r sp\xf8rringen, og velg s\xe5 ",(0,n.kt)("strong",{parentName:"li"},"SAVE RESULTS."))),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Lagre resultater i BigQuery console",src:r(7170).Z,width:"1272",height:"785"})),(0,n.kt)("ol",{start:4},(0,n.kt)("li",{parentName:"ol"},"Du vil f\xe5 sp\xf8rsm\xe5l om ulike lagringsmuligheter. Velg for eksempelvis ",(0,n.kt)("strong",{parentName:"li"},"JSON (local file).")," Denne nedlastingen st\xf8tter opp til 16 000 rader.")),(0,n.kt)("p",null,"Deretter kan du \xe5pne JSON-filen i et tekstredigeringsprogram, som eksempelvis ",(0,n.kt)("a",{parentName:"p",href:"https://code.visualstudio.com/"},"Visual Studio Code"),"."),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Vise JSON-data i VS Code",src:r(5282).Z,width:"1279",height:"685"})),(0,n.kt)("p",null,"Dataen kan prosesseres videre offline, ved hjelp av verkt\xf8y som ",(0,n.kt)("a",{parentName:"p",href:"https://stedolan.github.io/jq/"},"jq"),", eller lastes inn i et annet analyseprogram, som Excel, ",(0,n.kt)("a",{parentName:"p",href:"https://datastudio.google.com/"},"Data Studio")," eller ",(0,n.kt)("a",{parentName:"p",href:"https://powerbi.microsoft.com/"},"Power BI"),"."))}p.isMDXComponent=!0},3430:(e,t,r)=>{r.d(t,{Z:()=>a});const a=r.p+"assets/images/bruk-av-bq-9dd56dddb80d371fcda6dc92030a9d42.png"},7170:(e,t,r)=>{r.d(t,{Z:()=>a});const a=r.p+"assets/images/laste-ned-datasett-1-e2207a1e02e7793e8ff2d80ae2227b90.webp"},5282:(e,t,r)=>{r.d(t,{Z:()=>a});const a=r.p+"assets/images/laste-ned-datasett-2-cd4b2f3414e0a5822a87df301913e65d.webp"}}]);